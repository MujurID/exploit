# Open Redirect Vulnerability Lead to XSS Injection of Official Website PointBlank Zepetto Indonesia
### Author : Mikhro <br><a href="https://www.facebook.com/josh.s.mikhael" rel="nofollow"><img src="https://img.shields.io/badge/contact-facebook-blue.svg" alt="Twitter" data-canonical-src="https://img.shields.io/badge/facebook-josh.s.mikhael-blue.svg" style="max-width:100%;"></a>
> #Exploit #XSS #Injection #PointBlank_Zepetto #Bug #OpenRedirect



## Apa itu Open Redirect Vulnerability ??
Berdasarkan https://s0cket7.com/open-redirect-vulnerability/ dapat disimpulkan bahwa : <br>
**Open Redirect** atau **Pengalihan Terbuka** adalah jenis celah/bug yang memungkinkan seseorang untuk mengalihkan sebuah situs web (*web victim*)
menuju ke situs web apapun tanpa adanya ~~peringatan~~ akan meninggalkan website.

## Apa itu XSS Injection ?? 
Dikutip dari https://id.m.wikipedia.org/wiki/XSS, <br>
**XSS** merupakan salah satu jenis serangan *injeksi code* (code injection attack). XSS dilakukan oleh penyerang dengan cara memasukkan kode HTML atau client script code lainnya ke suatu situs. Serangan ini akan seolah-olah datang dari situs tersebut. Akibat serangan ini antara lain penyerang dapat mem-bypass keamanan di sisi klien, mendapatkan informasi sensitif, atau menyimpan aplikasi berbahaya.

## Proof Of Concept
Pada hari Minggu, 07/04/2019 sekitar jam 16.00 saya sedang duduk santai di teras rumah utk menikmati sore hari sambil ngopi . Saat itu saya merasa sangat bosan sehingga akhirnya saya memutuskan mengambil hp Android kesayangan saya dan berencana bermain PUBG sebentar . Sebelum main saya menyempatkan untuk melihat-lihat beranda facebook. Ketika scroll beranda , saya melihat ada postingan dari Official Fanpage PointBlank Zepetto Indonesia tentang update patch serta new map & new mode . Berhubung saya juga sudah lama tidak memainkan game tersebut , saya pun tertarik untuk mencari tahu eventÂ² apa saja yg sedang berlangsung di game ini .<br> Sampe akhirnya saya mengunjungi fanpage dari game ini. Setelah membaca postingan fanpage saya beralih untuk membaca berita langsung dari website resmi nya . Saat itu entah kenapa terlintas di pikiran saya untuk iseng mencari bug dan melakukan penetration testing pada website tersebut.

![Screenshot_Websige_Pb_Zepetto](https://robotmikhro.github.io/img/Screenshot_2019-04-11-15-52-53-567_com.android.chrome.png)

Hal pertama yang akan saya lakukan adalah melakukan pengecekan pada halaman dashboard user/halaman info. Setelah itu saya cek satu-satu pertama pada bagian Submit Ticket lalu halaman Profil dan Notification . Namun saya tidak menemukan adanya celah dibagian tersebut. Berpikir sejenak , sambil menyeruput kopi , tiba-tiba perhatian saya tertuju bagian widget "PUSAT ISI ULANG" . 

![ss-pusat-isi-ulang](https://robotmikhro.github.io/img/IMG_20190411_161346.jpg)
Pikir saya mungkin saja pada bagian tersebut ada form yg vuln akan xss atau gk sqli :v . Dengan rasa penasaran , saya pun mengklik widget tersebut . Setelah mengklik saya langsung ter-redirect ke website https://topup.pointblank.id/Topup/Index . Terlintas dalam pikiran saya bahwa ketika saya ter-redirect tidak ada notice akan meninggalkan website https://wwww.pointblank.id/mypage/info melainkan langsung ter-redirect begitu saja . "Hmm .. " , guman saya. "Mungkinkah vuln akan open redirect ?",kata saya dalam hati. <br> Untuk menyelidiki hal tersebut, saya pun mencari tools untuk melakukan sniff pada website, berhubung saya hanya bermodalkan Smartphone Android , saya memakai [Net Capture](https://play.google.com/store/apps/details?id=com.minhui.networkcapture&hl=en_US&referrer=utm_source%3Dgoogle%26utm_medium%3Dorganic%26utm_term%3Dnet+capture&pcampaignid=APPU_1_eguvXOzMLcz5vAS6lYfwDw). Sebelum itu saya kembali ke halaman info lalu menyalakan Net Capture dan mengklik ulang widget "PUSAT ISI ULANG PB" . Dan ini hasilnya :
![ss-hasil-sniff](https://robotmikhro.github.io/img/IMG_20190411_164357.jpg)

Jika kita lihat pada bagian GET ada parameter :
> ?redirect_url=https://topup.pointblank.id

Lalu saya coba ganti url pada param tsb dengan https://www.google.com , sehingga menjadi seperti ini :
> https://www.pointblank.id/topup/auth?redirect_url=https://www.google.com

Hasilnya website ter-redirect dengan baik ..
![ss-sukses-redir-ke-google](https://robotmikhro.github.io/img/IMG_20190411_172620.jpg)
![ss-hasil-sniff](https://robotmikhro.github.io/img/IMG_20190411_172804.jpg)
